---
export interface Props {
  categories: string[];
  brands: string[];
  selectedCategory?: string;
  selectedBrand?: string;
  selectedSort?: string;
  priceRange?: { min: number; max: number };
}

const { 
  categories, 
  brands, 
  selectedCategory = "", 
  selectedBrand = "", 
  selectedSort = "relevance",
  priceRange = { min: 0, max: 1000 }
} = Astro.props;
---

<div class="bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200 w-full">
  <div class="flex justify-between items-center mb-3 sm:mb-4">
    <h3 class="font-semibold text-base sm:text-lg text-gray-800">Filters</h3>
    <button 
      id="resetFilters" 
      class="text-xs sm:text-sm text-primary-600 hover:text-primary-700 font-medium"
    >
      Reset All
    </button>
  </div>
  
  <div class="space-y-4 sm:space-y-6">
    <!-- Category Filter -->
    <div>
      <h4 class="font-medium text-gray-700 text-sm sm:text-base mb-1 sm:mb-2">Category</h4>
      <select 
        id="categoryFilter" 
        class="w-full p-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
      >
        <option value="">All Categories</option>
        {
          categories.map(category => (
            <option value={category} selected={selectedCategory === category}>
              {category.charAt(0).toUpperCase() + category.slice(1).replace('-', ' ')}
            </option>
          ))
        }
      </select>
    </div>
    
    <!-- Brand Filter -->
    <div>
      <h4 class="font-medium text-gray-700 text-sm sm:text-base mb-1 sm:mb-2">Brand</h4>
      <select 
        id="brandFilter" 
        class="w-full p-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
      >
        <option value="">All Brands</option>
        {
          brands.map(brand => (
            <option value={brand} selected={selectedBrand === brand}>{brand}</option>
          ))
        }
      </select>
    </div>
    
    <!-- Price Range Filter -->
    <div>
      <h4 class="font-medium text-gray-700 text-sm sm:text-base mb-1 sm:mb-2">Max Price: $<span id="priceRangeValue">{priceRange.max}</span></h4>
      <div class="flex items-center space-x-2 mb-1 sm:mb-2">
        <span class="text-xs sm:text-sm text-gray-600">$0</span>
        <input 
          type="range" 
          id="priceRange" 
          min="0" 
          max="1000" 
          value={priceRange.max}
          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"
        />
        <span class="text-xs sm:text-sm text-gray-600">$1000+</span>
      </div>
    </div>
    
    <!-- Sort Options -->
    <div>
      <h4 class="font-medium text-gray-700 text-sm sm:text-base mb-1 sm:mb-2">Sort By</h4>
      <select 
        id="sortOptions" 
        class="w-full p-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
      >
        <option value="relevance" selected={selectedSort === "relevance"}>Relevance</option>
        <option value="price-low" selected={selectedSort === "price-low"}>Price: Low to High</option>
        <option value="price-high" selected={selectedSort === "price-high"}>Price: High to Low</option>
        <option value="rating" selected={selectedSort === "rating"}>Highest Rated</option>
        <option value="popular" selected={selectedSort === "popular"}>Most Popular</option>
      </select>
    </div>
  </div>
</div>

<script>
  // Update price range display
  const priceRange = document.getElementById('priceRange');
  const priceRangeValue = document.getElementById('priceRangeValue');
  
  if (priceRange && priceRangeValue) {
    priceRange.addEventListener('input', function() {
      priceRangeValue.textContent = this.value;
      // Auto-apply when price range changes
      setTimeout(() => applyFilters(), 300);
    });
  }
  
  // Auto-apply when filters change
  document.getElementById('categoryFilter')?.addEventListener('change', function() {
    applyFilters();
  });
  
  document.getElementById('brandFilter')?.addEventListener('change', function() {
    applyFilters();
  });
  
  document.getElementById('sortOptions')?.addEventListener('change', function() {
    applyFilters();
  });
  
  document.getElementById('resetFilters')?.addEventListener('click', function() {
    document.getElementById('categoryFilter').value = '';
    document.getElementById('brandFilter').value = '';
    document.getElementById('priceRange').value = 1000;
    document.getElementById('priceRangeValue').textContent = '1000';
    document.getElementById('sortOptions').value = 'relevance';
    applyFilters();
  });
  
  function applyFilters() {
    const category = document.getElementById('categoryFilter')?.value || '';
    const brand = document.getElementById('brandFilter')?.value || '';
    const maxPrice = document.getElementById('priceRange')?.value || 1000;
    const sortBy = document.getElementById('sortOptions')?.value || 'relevance';
    
    if (typeof window.applyFilters === 'function') {
      window.applyFilters(category, brand, maxPrice, sortBy);
    }
  }
</script>

<style>
  .slider::-webkit-slider-thumb {
    appearance: none;
    height: 16px;
    width: 16px;
    border-radius: 50%;
    background: #3b82f6;
    cursor: pointer;
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  
  .slider::-moz-range-thumb {
    height: 16px;
    width: 16px;
    border-radius: 50%;
    background: #3b82f6;
    cursor: pointer;
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
</style>