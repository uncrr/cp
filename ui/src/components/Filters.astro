---
export interface Props {
  categories: string[];
  brands: string[];
  selectedCategory?: string;
  selectedBrand?: string;
  selectedSort?: string;
  priceRange?: { min: number; max: number };
}

const { 
  categories, 
  brands, 
  selectedCategory = "", 
  selectedBrand = "", 
  selectedSort = "relevance",
  priceRange = { min: 0, max: 1000 }
} = Astro.props;
---

<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
  <h3 class="font-semibold text-lg mb-4 text-gray-800">Filters</h3>
  
  <div class="space-y-6">
    <!-- Category Filter -->
    <div>
      <h4 class="font-medium text-gray-700 mb-2">Category</h4>
      <select 
        id="categoryFilter" 
        class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"
      >
        <option value="">All Categories</option>
        {
          categories.map(category => (
            <option value={category} selected={selectedCategory === category}>
              {category.charAt(0).toUpperCase() + category.slice(1).replace('-', ' ')}
            </option>
          ))
        }
      </select>
    </div>
    
    <!-- Brand Filter -->
    <div>
      <h4 class="font-medium text-gray-700 mb-2">Brand</h4>
      <select 
        id="brandFilter" 
        class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"
      >
        <option value="">All Brands</option>
        {
          brands.map(brand => (
            <option value={brand} selected={selectedBrand === brand}>{brand}</option>
          ))
        }
      </select>
    </div>
    
    <!-- Price Range Filter -->
    <div>
      <h4 class="font-medium text-gray-700 mb-2">Price Range</h4>
      <div class="flex items-center space-x-2 mb-2">
        <span class="text-sm text-gray-600">$0</span>
        <input 
          type="range" 
          id="priceRange" 
          min="0" 
          max="1000" 
          value={priceRange.max}
          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
        />
        <span class="text-sm text-gray-600">$<span id="priceRangeValue">1000</span>+</span>
      </div>
    </div>
    
    <!-- Sort Options -->
    <div>
      <h4 class="font-medium text-gray-700 mb-2">Sort By</h4>
      <select 
        id="sortOptions" 
        class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"
      >
        <option value="relevance" selected={selectedSort === "relevance"}>Relevance</option>
        <option value="price-low" selected={selectedSort === "price-low"}>Price: Low to High</option>
        <option value="price-high" selected={selectedSort === "price-high"}>Price: High to Low</option>
        <option value="rating" selected={selectedSort === "rating"}>Highest Rated</option>
        <option value="popular" selected={selectedSort === "popular"}>Most Popular</option>
      </select>
    </div>
    
    <!-- Apply Filters Button -->
    <button 
      id="applyFilters" 
      class="w-full bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 transition-colors"
    >
      Apply Filters
    </button>
    
    <!-- Reset Filters -->
    <button 
      id="resetFilters" 
      class="w-full bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors"
    >
      Reset Filters
    </button>
  </div>
</div>

<script>
  // Update price range display
  const priceRange = document.getElementById('priceRange');
  const priceRangeValue = document.getElementById('priceRangeValue');
  
  if (priceRange && priceRangeValue) {
    priceRange.addEventListener('input', function() {
      priceRangeValue.textContent = this.value;
    });
  }
  
  // Filter application
  document.getElementById('applyFilters')?.addEventListener('click', function() {
    applyFilters();
  });
  
  document.getElementById('resetFilters')?.addEventListener('click', function() {
    document.getElementById('categoryFilter').value = '';
    document.getElementById('brandFilter').value = '';
    document.getElementById('priceRange').value = 1000;
    document.getElementById('priceRangeValue').textContent = '1000';
    document.getElementById('sortOptions').value = 'relevance';
    applyFilters();
  });
  
  // Auto-apply when filters change
  document.getElementById('categoryFilter')?.addEventListener('change', applyFilters);
  document.getElementById('brandFilter')?.addEventListener('change', applyFilters);
  document.getElementById('priceRange')?.addEventListener('change', applyFilters);
  document.getElementById('sortOptions')?.addEventListener('change', applyFilters);
  
  function applyFilters() {
    const category = document.getElementById('categoryFilter')?.value || '';
    const brand = document.getElementById('brandFilter')?.value || '';
    const maxPrice = document.getElementById('priceRange')?.value || 1000;
    const sortBy = document.getElementById('sortOptions')?.value || 'relevance';
    
    if (typeof window.applyFilters === 'function') {
      window.applyFilters(category, brand, maxPrice, sortBy);
    }
  }
</script>